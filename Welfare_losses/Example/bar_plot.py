import pandas as pd
import numpy as np
import math
import geopandas as gpd
import matplotlib.pyplot as plt
import matplotlib.ticker as ticker

# plot bar chart of losses
index=0
df1 = pd.read_csv(rf"p:\11209200-020-sociale-kwetsbaarheid\Wellbeing_Charleston\data\{index}_variables.csv",
                  index_col=0)
index=42
df2 = pd.read_csv(rf"p:\11209200-020-sociale-kwetsbaarheid\Wellbeing_Charleston\data\{index}_variables.csv",
                  index_col=0)

df = pd.concat([df1, df2])
df.set_index("index", inplace=True, drop=True)

def format_func(value, _):
    # Convert the value into a formatted string with spacing
    return "{:,.0f}".format(value)


fig, ax = plt.subplots()
colors = ['#DDDDDD', '#777777', '#000000']
df[['delta_W', 'delta_kstr', 'delta_i']].plot(ax=ax, kind="barh", stacked=False, color=colors)
ax.legend(["Well-being losses", "Housing asset losses", "Income losses"])
ax.xaxis.set_major_formatter(ticker.FuncFormatter(format_func))
ax.set_xlabel("Losses (US$)")
plt.tight_layout()
plt.savefig(rf"p:\11209200-020-sociale-kwetsbaarheid\Wellbeing_Charleston\figures\bar_chart_losses.png")
plt.show()
import geopandas as gpd
import os

pdir = r'p:\11209200-020-sociale-kwetsbaarheid\Data'
uvzone = gpd.read_file(os.path.join(pdir, 'Population', 'UVZONE.shp'))
azone = gpd.read_file(os.path.join(pdir, 'Income', 'AZONE.shp'))

# drop ID from uvzone
uvzone = uvzone.drop(columns=['ID'])

# reproject crs
crs = 'EPSG:4326'
uvzone = uvzone.to_crs(crs)

# spatial join
gdf = gpd.sjoin(azone, uvzone, how='inner', predicate='intersects')
gdf.groupby('ID')['POP16'].sum()
gdf.to_file(os.path.join(pdir, 'Income', 'AZONEwithPop.shp'))
